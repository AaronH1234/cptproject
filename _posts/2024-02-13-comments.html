<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Restaurant Comments</title>
    <style>
        /* Add future CSS styles JASON COOK UP HERE MAYBE? */
    </style>
</head>
<body>
    <h1>Restaurant Comments</h1>

    <!-- Form for submitting a new comment -->
    <form id="commentForm">
        <label for="restaurantName">Restaurant Name:</label>
        <input type="text" id="restaurantName" name="restaurantName" required><br><br>

        <label for="rating">Rating (1-10):</label>
        <input type="number" id="rating" name="rating" min="1" max="10" required><br><br>

        <button type="submit">Submit Comment</button>
    </form>

    <!-- Display area for existing comments -->
    <div id="commentsContainer">
        <h2>Comments:</h2>
        <ul id="commentsList">
            <!-- Comments will be dynamically inserted here -->
        </ul>
    </div>

    <script>
// Function to fetch comments from the backend
function fetchComments() {
    fetch('http://127.0.0.1:8888/api/comments')
        .then(response => response.json())
        .then(data => {
            // Assuming data is an array of comment objects
            // Iterate through the comments and display them in the comments list
            const commentsList = document.getElementById('commentsList');
            commentsList.innerHTML = ''; // Clear previous comments
            data.forEach(comment => {
                const listItem = document.createElement('li');
                listItem.textContent = `${comment.restaurantName}: ${comment.rating}`;
                commentsList.appendChild(listItem);
            });
        })
        .catch(error => {
            console.error('Error fetching comments:', error);
        });
}

// Function to submit a new comment to the backend
function submitComment(event) {
    event.preventDefault(); // Prevent default form submission

    const formData = new FormData(document.getElementById('commentForm'));
    const requestData = {
        method: 'POST',
        body: JSON.stringify(Object.fromEntries(formData)),
        headers: {
            'Content-Type': 'application/json'
        }
    };

    fetch('http://127.0.0.1:8888/api/comments', requestData)
        .then(response => {
            if (!response.ok) {
                throw new Error('Failed to submit comment');
            }
            // If successful, fetch updated comments
            fetchComments();
            // Clear the form after successful submission
            document.getElementById('commentForm').reset();
        })
        .catch(error => {
            console.error('Error submitting comment:', error);
        });
}

// Fetch comments when the page loads
window.onload = function() {
    fetchComments();
    // Attach event listener to the comment form
    document.getElementById('commentForm').addEventListener('submit', submitComment);
};

    </script>
</body>
</html>
